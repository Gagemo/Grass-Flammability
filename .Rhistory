# PCH codes 0-8 are distinct, non-filled shapes.
# The `color` aesthetic will control their appearance.
# PCH codes 21-25 are filled shapes, with a border controlled by `color`.
# We'll need a mix to ensure we have enough unique shapes.
unique_shapes <- c(21, 22, 23, 24, 25, 15, 16, 17, 18)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5, color = "black")),
fill = "none")
# Define a vector of nine unique shape values.
# PCH codes 0-8 are distinct, non-filled shapes.
# The `color` aesthetic will control their appearance.
# PCH codes 21-25 are filled shapes, with a border controlled by `color`.
# We'll need a mix to ensure we have enough unique shapes.
unique_shapes <- c(21, 22, 23, 24, 25, 10, 11, 12, 9)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5, color = "black")),
fill = "none")
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5, color = "black")),
fill = "none")
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = "black", colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, colour = Species), fill = "black",
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 2, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 1, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 1, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 1, byrow = TRUE,    # 2 rows
override.aes = list(size = 2)))
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 1, byrow = TRUE,    # 2 rows
override.aes = list(size = 5))) +
guides( color = guide_legend(nrow = 1, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 30)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 30)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 30)) +
guides( shape = guide_legend(nrow = 1, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette) +
scale_color_manual(values = cbbPalette) +
scale_shape_manual(values = unique_shapes) +
guides( shape = guide_legend(nrow = 1, byrow = TRUE,
override.aes = list(size = 5)))
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
# Plot 1: PCA biplot colored and shaped by Species
ggplot(pca_scores, aes(x = PC1, y = PC2)) +
geom_point(aes(shape = Species, fill = Species, colour = Species),
size = 6, stroke = 1.2) +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1 * 0.5, yend = PC2 * 0.5),
arrow = arrow(length = unit(0.3, "cm")), size = 1.5, color = "black") +
geom_text(data = loadings, aes(x = PC1 * 0.5, y = PC2 * 0.5, label = Flammability),
color = "black", vjust = -0.5, hjust = 0.5, size = 8) +
xlab(paste("PC1 (", round(summary(pca)$cont$importance[2, 1] * 100, 1), "%)", sep = "")) +
ylab(paste("PC2 (", round(summary(pca)$cont$importance[2, 2] * 100, 1), "%)", sep = "")) +
theme_classic() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.title = element_text(hjust = 0.5, face="bold", colour = "black"),
text=element_text(size=20),
axis.title.x = element_text(face="bold", colour = "black"),
axis.title.y = element_text(face="bold", colour = "black"),
axis.text.x=element_text(size = 20, face = "bold", color = "black"),
axis.text.y=element_text(size = 20, face = "bold", color = "black"),
strip.text.x = element_text(size = 20, colour = "black", face = "bold"),
legend.text = element_text(size = 20, face = "italic"),
legend.box = "horizontal",
legend.position = "bottom") +
scale_fill_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_color_manual(values = cbbPalette, labels = function(x) str_wrap(x, width = 10)) +
scale_shape_manual(values = unique_shapes, labels = function(x) str_wrap(x, width = 10)) +
guides( shape = guide_legend(nrow = 1, byrow = TRUE,    # 2 rows
override.aes = list(size = 5)))
ggsave("Figures/Box_PCA.png",
width = 19, height = 12)
